(()=>{"use strict";var e={840:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0})},373:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UploaderMaxFilesNumber=o.UploadFileInputSelector=o.DownloadButtonSelector=o.SaveToGoogleButtonUploadIconSelector=o.SaveToGoogleButtonSpinnerIconSelector=o.SaveToGoogleButtonSelector=o.UploadToGoogleButtonSelector=o.SaveToDropboxButtonUploadIconSelector=o.SaveToDropboxButtonSpinnerIconSelector=o.UplodToDropboxButtonImageSelector=o.UploadToDropboxButtonSelector=o.SaveToDropboxButtonSelector=void 0,o.SaveToDropboxButtonSelector="#UploadToDropboxButton",o.UploadToDropboxButtonSelector="#dropbox-btn",o.UplodToDropboxButtonImageSelector="".concat(o.UploadToDropboxButtonSelector," > svg"),o.SaveToDropboxButtonSpinnerIconSelector="".concat(o.SaveToDropboxButtonSelector," i.fa-spinner"),o.SaveToDropboxButtonUploadIconSelector="".concat(o.SaveToDropboxButtonSelector," i.fa-upload"),o.UploadToGoogleButtonSelector="#googledrive-btn",o.SaveToGoogleButtonSelector="#UploadToGoogleButton",o.SaveToGoogleButtonSpinnerIconSelector="".concat(o.SaveToGoogleButtonSelector," i.fa-spinner"),o.SaveToGoogleButtonUploadIconSelector="".concat(o.SaveToGoogleButtonSelector," i.fa-upload"),o.DownloadButtonSelector="#DownloadButton",o.UploadFileInputSelector="#UploadFileInput-1",o.UploaderMaxFilesNumber=10},522:function(e,o,t){var n=this&&this.__awaiter||function(e,o,t,n){return new(t||(t=Promise))((function(r,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function l(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var o;e.done?r(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,l)}u((n=n.apply(e,o||[])).next())}))},r=this&&this.__generator||function(e,o){var t,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=o.call(e,a)}catch(e){i=[6,e],n=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}};Object.defineProperty(o,"__esModule",{value:!0}),t(840);var i=t(828),a=t(373),l=function(){function e(){}return e.prototype.initalizeDropboxUploadFromButton=function(){var e=this;$(a.UploadToDropboxButtonSelector).click((function(){return n(e,void 0,void 0,(function(){var e,o;return r(this,(function(t){switch(t.label){case 0:return $(a.UploadToDropboxButtonSelector).addClass("animatedsvg"),e=a.UploaderMaxFilesNumber,[4,this.loadDropboxScripts()];case 1:return t.sent(),[4,this.getFilesFromDropbox(e>1)];case 2:return o=t.sent(),[4,this.uploadFilesFromDropbox(o,e)];case 3:return t.sent(),[2]}}))}))}))},e.prototype.getFilesFromDropbox=function(e){return new Promise((function(o,t){window.Dropbox.choose({success:function(e){o(e)},cancel:function(){o([])},linkType:"direct",multiselect:e,extensions:window.AcceptedExtensions?window.AcceptedExtensions.split(",").map((function(e){return e.trim()})):null})}))},e.prototype.uploadFilesFromDropbox=function(e,o){return n(this,void 0,void 0,(function(){var t,n,i,l,u;return r(this,(function(r){return e&&e.length?(t=e.slice(0,o).map((function(e){return{name:e.name,id:e.link,mimeType:e.mimeType}})),n=window.uploadDropboxFiles,(i=n||[]).map((function(e){return e.id})),l=t.map((function(e){return{id:e.id,name:e.name,mimeType:e.mimeType}})).concat(i),window.uploadDropboxFiles=l,(u=new Event("change")).data={files:t},$(a.UploadFileInputSelector)[0].dispatchEvent(u),[2,!0]):[2,!1]}))}))},e.prototype.loadDropboxScripts=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,(0,i.attachScript)("https://www.dropbox.com/static/api/2/dropins.js",{"data-app-key":$(a.UploadToDropboxButtonSelector).length?$(a.UploadToDropboxButtonSelector).data("dropboxAppId"):$(a.SaveToDropboxButtonSelector).data("dropboxAppId"),id:"dropboxjs"})];case 1:return e.sent(),[2]}}))}))},e.prototype.showDropboxSpinner=function(){$(a.SaveToDropboxButtonSpinnerIconSelector).show(),$(a.SaveToDropboxButtonUploadIconSelector).hide()},e.prototype.hideDropboxSpinner=function(){$(a.SaveToDropboxButtonSpinnerIconSelector).hide(),$(a.SaveToDropboxButtonUploadIconSelector).show()},e.prototype.saveFilesToDropbox=function(e){return n(this,void 0,void 0,(function(){var o,t,n=this;return r(this,(function(r){switch(r.label){case 0:return[4,this.loadDropboxScripts()];case 1:return r.sent(),o=$(a.DownloadButtonSelector).attr("href"),t=[{url:o,filename:e}],this.showDropboxSpinner(),[2,new Promise((function(e,o){window.Dropbox.save({files:t,success:function(){var o=$(a.SaveToDropboxButtonSelector).data("successMessage").replace("{0}","Dropbox");updateCloudMessage(o,!0),n.hideDropboxSpinner(),e(!0)},progress:function(e){},cancel:function(){n.hideDropboxSpinner(),e(!1)},error:function(e){var t=$(a.SaveToDropboxButtonSelector).data("errorMessage").replace("{0}","Dropbox").replace("{1}",e||"Unknown error");updateCloudMessage(t,!1),n.hideDropboxSpinner(),o(e)}})}))]}}))}))},e}();o.default=l},623:function(e,o,t){var n=this&&this.__awaiter||function(e,o,t,n){return new(t||(t=Promise))((function(r,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function l(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var o;e.done?r(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,l)}u((n=n.apply(e,o||[])).next())}))},r=this&&this.__generator||function(e,o){var t,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=o.call(e,a)}catch(e){i=[6,e],n=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}};Object.defineProperty(o,"__esModule",{value:!0}),t(840);var i=t(828),a=t(373);function l(e){return $(a.UploadToGoogleButtonSelector).length?$(a.UploadToGoogleButtonSelector).data(e):$(a.SaveToGoogleButtonSelector).length?$(a.SaveToGoogleButtonSelector).data(e):""}var u=function(){return l("googleAppId")},c=function(){return l("googleDeveloperKey")},s=function(){function e(){var e=this;this._apiLoader=new p,this._auth=new d,this._defaultFolderCreator=new f,this.uploadFromGoogleDrive=function(o,t){return n(e,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return[4,this._apiLoader.load()];case 1:return n.sent(),[4,this._auth.auth()];case 2:return n.sent(),[4,this.createUploadPicker(o)];case 3:return(e=n.sent())&&e.length&&t&&t(),[2,this.uploadFromGoogleDisk(e)]}}))}))},this.uploadFile=function(){return n(e,void 0,void 0,(function(){var e;return r(this,(function(o){switch(o.label){case 0:return[4,this._apiLoader.load()];case 1:return o.sent(),[4,this._auth.auth()];case 2:return o.sent(),[4,this.createUploadPicker(1)];case 3:return(e=o.sent())&&e.length?[2,$.ajax({method:"GET",headers:{Authorization:"Bearer "+this._auth.oAuthToken()},url:"https://www.googleapis.com/drive/v3/files/".concat(e[0].id,"?alt=media")})]:[2,null]}}))}))},this.saveToGoogleDrive=function(o,t){return n(e,void 0,void 0,(function(){var e,n;return r(this,(function(r){switch(r.label){case 0:return(e=$("#DownloadButton").attr("href"))?[4,this._apiLoader.load()]:[2,!1];case 1:return r.sent(),[4,this._auth.auth()];case 2:return r.sent(),[4,this.createSavePicker()];case 3:return n=r.sent(),[4,this.saveToGoogleApiCall(n,e,o,t)];case 4:return[2,r.sent()]}}))}))}}return e.prototype.createUploadPicker=function(e){return n(this,void 0,void 0,(function(){var o=this;return r(this,(function(t){return[2,new Promise((function(t,n){var r=l("extensions").split(",").map((function(e){return e.trim().toLowerCase()})),i=null;r&&r.length&&((i=new google.picker.DocsView(google.picker.ViewId.DOCS).setIncludeFolders(!0)).setQuery(r.map((function(e){return"*"+e})).join("|")),i.setLabel(l("filteredByExtension")));var a=new google.picker.DocsView(google.picker.ViewId.DOCS);a.setIncludeFolders(!0),a.setLabel(l("fullContent"));var s=(new google.picker.PickerBuilder).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setAppId(u()).setDeveloperKey(c()).setOAuthToken(o._auth.oAuthToken());i&&(s=s.addView(i)),s.addView(a).setMaxItems(e).setOrigin(window.location.protocol+"//"+window.location.host).setLocale(window.locale).setCallback((function(e){if(e.action===google.picker.Action.PICKED){var o=void 0;if(r){var n=e.docs.filter((function(e){return e.name.includes(".")})).map((function(e){return"."+e.name.split(".").pop().toLowerCase()})).filter((function(e){return!r.includes(e)})).filter((function(e,o,t){return t.indexOf(e)===o})).map((function(e){return e.replace(".","").toUpperCase()}));n.length&&(1===n.length?showAlert("File type ".concat(n[0]," is not supported")):showAlert("File types ".concat(n.join(", ")," are not supported"))),o=e.docs.filter((function(e){if(!e.name.includes("."))return!1;var o="."+e.name.split(".").pop().toLowerCase();return r.includes(o)}))}else o=e.docs;t(o)}else e.action===google.picker.Action.CANCEL&&t()})).build().setVisible(!0)}))]}))}))},e.prototype.createSavePicker=function(){return n(this,void 0,void 0,(function(){var e=this;return r(this,(function(o){return[2,new Promise((function(o,t){var n=new google.picker.DocsView(google.picker.ViewId.FOLDERS);n.setIncludeFolders(!0),n.setLabel(l("directories")),n.setSelectFolderEnabled(!0),(new google.picker.PickerBuilder).setAppId(u()).setDeveloperKey(c()).setOAuthToken(e._auth.oAuthToken()).addView(n).setMaxItems(1).setOrigin(window.location.protocol+"//"+window.location.host).setLocale(window.locale).setCallback((function(e){if(e.action===google.picker.Action.PICKED){var t=null;e.docs.length&&(t=e.docs[0].id),o(t)}else e.action===google.picker.Action.CANCEL&&o()})).build().setVisible(!0)}))]}))}))},e.prototype.uploadFromGoogleDisk=function(e){return n(this,void 0,void 0,(function(){var o,t,n,i;return r(this,(function(r){return e&&e.length?(o=window.uploadGoogleFiles,t=o?o.Files:[],t.map((function(e){return e.id})),n={Files:e.map((function(e){return{id:e.id,name:e.name,mimeType:e.mimeType}})).concat(t),Token:this._auth.oAuthToken(),IdUpload:"1"},window.uploadGoogleFiles=n,(i=new Event("change")).data={files:e},$(a.UploadFileInputSelector)[0].dispatchEvent(i),[2,!0]):[2,!1]}))}))},e.prototype.saveToGoogleApiCall=function(e,o,t,i){return n(this,void 0,void 0,(function(){var n=this;return r(this,(function(r){return e&&o?(this.showGoogleSpinner(),[2,$.ajax({method:"POST",url:"".concat(i,"UploadDocumentToGoogle"),data:JSON.stringify({Token:this._auth.oAuthToken(),Files:[{Link:o,Name:t}],GoogleFolderId:e}),contentType:"application/json",dataType:"json",timeout:6e4}).then((function(e){return n.checkGoogleUploadResponse(e)}),(function(e){return n.checkGoogleUploadResponse(e)}))]):[2,!1]}))}))},e.prototype.checkGoogleUploadResponse=function(e){if(200==e.status){var o=$(a.SaveToGoogleButtonSelector).data("successMessage").replace("{0}","Google");updateCloudMessage(o,!0)}else{o=$(a.SaveToGoogleButtonSelector).data("errorMessage").replace("{0}","Google").replace("{1}",e.statusText||"Unknown error");updateCloudMessage(o,!1)}this.hideGoogleSpinner()},e.prototype.showGoogleSpinner=function(){$(a.SaveToGoogleButtonSpinnerIconSelector).show(),$(a.SaveToGoogleButtonUploadIconSelector).hide()},e.prototype.hideGoogleSpinner=function(){$(a.SaveToGoogleButtonSpinnerIconSelector).hide(),$(a.SaveToGoogleButtonUploadIconSelector).show()},e.prototype.loadGoogleDriveScripts=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,(0,i.attachScript)("https://apis.google.com/js/api.js")];case 1:return e.sent(),[4,(0,i.attachScript)("https://apis.google.com/js/platform.js")];case 2:return e.sent(),[2]}}))}))},e.prototype.initalizeGoogleUploadFromButton=function(){var e=this;$(a.UploadToGoogleButtonSelector).click((function(){return n(e,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return $(a.UploadToGoogleButtonSelector).addClass("disabled"),[4,this.loadGoogleDriveScripts()];case 1:return e.sent(),$(a.UploadToGoogleButtonSelector).removeClass("disabled"),[4,this.uploadFromGoogleDrive(1,(function(){}))];case 2:return e.sent(),[2]}}))}))}))},e.prototype.saveFilesToGoogleDrive=function(e,o){return n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.loadGoogleDriveScripts()];case 1:return t.sent(),[4,this.saveToGoogleDrive(e,o)];case 2:return[2,t.sent()]}}))}))},e}();o.default=s;var p=function(){var e=this;this._apiLoaded=!1,this.load=function(){return n(e,void 0,void 0,(function(){var e=this;return r(this,(function(o){return[2,new Promise((function(o,t){e._apiLoaded?o():window.gapi.load("picker",(function(){e._apiLoaded=!0,o()}))}))]}))}))}},d=function(){var e=this;this._oAuthToken=null,this.auth=function(){return n(e,void 0,void 0,(function(){var e=this;return r(this,(function(o){return[2,new Promise((function(o,t){e._oAuthToken?o(e._oAuthToken):window.gapi.load("auth",(function(){window.gapi.auth.authorize({client_id:l("googleClientId"),scope:["https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/drive.readonly"],immediate:!1},(function(n){n.access_token?(e._oAuthToken=n.access_token,o(e._oAuthToken)):t(n.error)}))}))}))]}))}))},this.oAuthToken=function(){return e._oAuthToken}},f=function(){var e=this;this._defaultFolderCreated=!1,this.createDefaultFolderIfNotExists=function(o,t){return e._defaultFolderCreated?Promise.resolve(!1):$.ajax({method:"POST",url:"".concat(t,"CreateGoogleDriveFolderIfNotExist"),data:JSON.stringify({Token:o}),contentType:"application/json",dataType:"json",timeout:6e4,success:function(){e._defaultFolderCreated=!0}})}}},828:function(e,o){var t=this&&this.__awaiter||function(e,o,t,n){return new(t||(t=Promise))((function(r,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function l(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var o;e.done?r(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,l)}u((n=n.apply(e,o||[])).next())}))},n=this&&this.__generator||function(e,o){var t,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=o.call(e,a)}catch(e){i=[6,e],n=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}};Object.defineProperty(o,"__esModule",{value:!0}),o.attachScript=void 0,o.attachScript=function(e,o){return void 0===o&&(o={}),t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,new Promise((function(t,n){if(document.querySelectorAll("script[src='"+e+"']").length>0)t();else{var r=document.createElement("script");for(var i in r.type="text/javascript",r.src=e,o)r.setAttribute(i,o[i]);r.addEventListener("load",(function(){return t()})),document.head.appendChild(r)}}))]}))}))}}},o={};function t(n){var r=o[n];if(void 0!==r)return r.exports;var i=o[n]={exports:{}};return e[n].call(i.exports,i,i.exports,t),i.exports}var n={};(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0});var o=t(522),r=t(623),i=new o.default;window.initalizeDropboxUploadFromButton=function(){return i.initalizeDropboxUploadFromButton()},window.saveFilesToDropbox=function(e){return i.saveFilesToDropbox(e)};var a=new r.default;window.initalizeGoogleUploadFromButton=function(){return a.initalizeGoogleUploadFromButton()},window.saveFilesToGoogleDrive=function(e,o){return a.saveFilesToGoogleDrive(e,o)}})();for(var r in n)this[r]=n[r];n.__esModule&&Object.defineProperty(this,"__esModule",{value:!0})})();