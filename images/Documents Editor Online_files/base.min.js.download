function gaEventSocial(t,r,a){if(r=r||"Social","ga"in window)try{const n=window.ga.getAll()[0];if(void 0!==n){let e={eventCategory:r,eventAction:t};void 0!==a&&(e.eventLabel=a),n.send("event",e)}}catch(e){}}function shareApp(t,e=!1){if(-1!==["facebook","twitter","linkedin","vk","odnoklassniki","cloud","github","feedback","otherapp","bookmark","zapier","clipboard","link"].indexOf(t)){var r=-1!==window.location.hostname.indexOf("localhost")?"products.aspose.app":window.location.hostname,n=window.location.pathname,s=encodeURI("https://"+r+n),i=encodeURI("https://"+r+"/words/common/img/howto.png"),l=document.title.replace("&","and"),n="cloud"!==t?t.charAt(0).toUpperCase()+t.slice(1):"WordsCloud",r="undefined"!=typeof InstallTrigger;e?gaEventSocial(n,"SocialNPS",$("#nps-step-6 > .nps-step__row")[0].getAttribute("data-nps")):gaEventSocial(n);var d=e=>{let t=t||window.event;t=t.target||t.srcElement,"A"!==t.tagName&&(a=document.createElement("a"),a.href=e,a.setAttribute("target","_blank"),a.click())};if("facebook"!==t||r)if(-1!==["facebook","twitter","linkedin","vk","odnoklassniki"].indexOf(t)){let e;switch(t){case"facebook":e=`https://www.facebook.com/sharer/sharer.php?u=${s}&picture=${i}&popup=true&app_id=813346076044703`;break;case"twitter":e=`https://twitter.com/intent/tweet?text=${encodeURI(l)}&url=${s}&hashtags=${o.AppName}`;break;case"linkedin":e="https://www.linkedin.com/sharing/share-offsite/?url="+s;break;case"vk":e="http://vk.com/share.php?url="+s,l&&(e+="&title="+encodeURIComponent(l)),i&&(e+="&image="+i),e+="&noparse=true";break;case"odnoklassniki":e="https://connect.ok.ru/offer?url="+s}n=(window.innerWidth-560)/2,r=(window.innerHeight-520)/2;window.open(e,"Social",`width=560,height=520,left=${n},top=${r},menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=no`)}else switch(t){case"link":case"clipboard":var u=document.URL.replace("#","");navigator.clipboard.writeText(u),$("#nps-step-6").find(".fa-clipboard").removeClass("fa-clipboard").removeClass("fa-link").addClass("fa-check-circle");break;case"otherapp":break;case"cloud":d("https://products.aspose.cloud/words/family");break;case"github":d("https://github.com/aspose-words/Aspose.Words-for-.NET");break;case"zapier":d("https://docs.aspose.cloud/words/plugins/zapier/")}else FB.ui({display:"popup",method:"share",href:s},function(e){})}}!function(v){v.fn.filedrop=function(d,e){let u=null,c=null;const p=e,g=d.Accept.split(/\s*,\s*/).map(function(e){return e.substring(1).toUpperCase()});let m=[];const h=function(e){(e=e||event).preventDefault(),e.stopPropagation()},f=function(e,t){const r=function(){let t=1,r;do{r=!1;for(let e=0;e<m.length;e++)if(m[e].id===t){t+=1,r=!0;break}}while(r);return t}();var a=e.name;t=t||!1;let n=null,o=null;d.UseSorting&&(n=v('                    <span class="fileMoveUpLink">                        <i class="fas fa-arrow-up"></i>                    </span>                '),o=v('                    <span class="fileMoveDownLink">                        <i class="fas fa-arrow-down"></i>                    </span>                '),n.on("click",function(){!function(e){let t;for(t=0;t<m.length&&m[t].id!==e;t++);var r,a;t<m.length&&0!==t&&(r=m[t-1].id,a=m[t-1],m[t-1]=m[t],m[t]=a,a=v("#filedrop-"+p+" > #fileupload-"+e).detach(),v("#filedrop-"+p+" > #fileupload-"+r).before(a))}(r)}),o.on("click",function(){!function(e){let t;for(t=0;t<m.length&&m[t].id!==e;t++);var r,a;t<m.length&&t!==m.length-1&&(r=m[t+1].id,a=m[t+1],m[t+1]=m[t],m[t]=a,a=v("#filedrop-"+p+" > #fileupload-"+e).detach(),v("#filedrop-"+p+" > #fileupload-"+r).after(a))}(r)}));const s=v('                <span class="fileRemoveLink">                    <i class="far fa-minus-square"></i>                </span>            ');s.on("click",function(){!function(e){let t;for(t=0;t<m.length&&m[t].id!==e;t++);t<m.length&&(null!==c&&c(m[t]),m.splice(t,1),v("#filedrop-"+p).find("#fileupload-"+e).remove(),0===m.length&&v("#filedrop-"+p).find(".chooseFilesLabel").removeClass("d-none")),0==m.length&&v("#filedrop-"+p).children("label").removeClass("d-none")}(r)});var i=v('                <span class="filename">\t\t\t\t<label>'+a+"</label>                </span>            ");const l=v('<div id="fileupload-'+r+'" class="fileupload"></div>');l.on("dragover",h),l.on("drop",h),l.append(i),null!==n&&null!==o&&(l.append(n),l.append(o)),l.append(s),v("#filedrop-"+p).append(l),m.push({id:r,file:e,name:a,virtual:t})},i=function(t){var r;let a;for(let e=0;e<m.length;e++)if(a=m[e],!a.virtual){if(null===(r=0<=(r=a.name.lastIndexOf("."))?a.name.substring(r+1).toUpperCase():null)||-1===d.UploadOptions.indexOf(r))return d.showAlert(d.FileWrongTypeMessage+r),null;t.append(a.id,a.file,a.name)}},t=function(t=1,r=void 0){void 0===r&&(r=d.MaximumUploadFiles);const a=m.filter(e=>!!e.virtual).map(e=>e.file.id);if(m.length){if(m.length<t||m.length>r)return d.showAlert(d.FileAmountMessage),null;const o=new FormData;var n="uploadGoogleFiles",t="uploadDropboxFiles";const s=window[n];s&&(r=s.Files.filter(e=>-1!==a.indexOf(e.id)),s.Files=r);let e=window[t];return e&&(e=e.filter(e=>-1!==a.indexOf(e.id)),window[t]=e),s&&0<s.Files.length&&o.append(n,JSON.stringify(s)),e&&0<e.length&&o.append(t,JSON.stringify({Files:e})),i(o),o}return d.showAlert(d.FileSelectMessage),null},r=function(e){let r=!1;var a,n,o=!!(e.originalEvent&&e.originalEvent.data&&e.originalEvent.data.files),s=!!(e&&e.data&&e.data.files),i=(s?e.data:o?e.originalEvent.data:e.target).files;if(i&&i.length){var t=i.length+m.length,e=getArchiveFilesNumber(i);if(1<e||1===e&&0<t-1)r=!0,d.showAlert(d.OnlyOneArchiveFile),window.setTimeout(function(){d.hideAlert()},5e3);else if(t<=d.MaximumUploadFiles){let t;d.hideAlert(),files_max=[];for(let e=0;e<i.length;e++){var l=i[e];t=(n=void 0,-1!==(n=(a=l).name.lastIndexOf("."))?a.name.substring(n+1).toUpperCase():null),null!==t&&-1!==g.indexOf(t)||"GZ"===t?l.size>d.MaximumUploadSize?files_max.push(l.name):(v("#filedrop-"+p).find(".chooseFilesLabel").addClass("d-none"),f(l,s||o)):(r=!0,null!==t&&(t=t.toUpperCase()),d.showAlert(d.FileWrongTypeMessage+t))}0<files_max.length&&(r=!0,d.showAlert(d.MaximumUploadSizeMessage+files_max.join(", ")))}else r=!0,d.showAlert(d.FileAmountMessage),window.setTimeout(function(){d.hideAlert()},5e3);r||isEbook||(loadPromo(),0<t?v("#filedrop-"+p).children("label").addClass("d-none"):v("#filedrop-"+p).children("label").removeClass("d-none")),null!==u&&u(i)}return v("input#UploadFileInput-"+p).val(""),!r};return d.UploadAndRedirect?v("input#UploadFileInput-"+p).on("change",function(e){r(e)&&null!=t()&&(d.showLoader(),d.Method())}):v("input#UploadFileInput-"+p).on("change",r),{get droppedFiles(){return m},get prepareFormData(){return t},on:function(e,t){"function"==typeof t&&("upload"===e?u=t:"remove"===e&&(c=t))},off:function(e){"upload"===e?u=null:"remove"===e&&(c=null)},addFilesToFormData:i,reset:function(){m=[],v("#filedrop-"+p).find("div[id^=fileupload-]").remove(),v("#filedrop-"+p).find(".chooseFilesLabel").removeClass("d-none"),v("#filedrop-"+p).children("label").removeClass("d-none")}}}}(jQuery),window.fbAsyncInit=function(){FB.init({appId:"813346076044703",autoLogAppEvents:!0,xfbml:!0,version:"v11.0"})};const NPS_STORAGE_KEY="nps-score",NPS_STEP_COUNT=6;let formParameters={},npsGrade={appname:"",score:null,fileId:"",message:"",message2:"",email:"",additional:"",formparameters:{},referer:document.location.pathname};const sendNpsScore=(r=5,a=!1)=>{if(null!==npsGrade.score||npsGrade.message||npsGrade.message2||npsGrade.email){let t;try{if(t=JSON.parse(window.localStorage.getItem(NPS_STORAGE_KEY)),!t)throw new Exception}catch(e){t={}}t[o.AppName]=npsGrade.score,window.localStorage.setItem(NPS_STORAGE_KEY,JSON.stringify(t)),npsGrade.appname=o.AppName,npsGrade.formparameters=JSON.stringify(formParameters);let e=void 0!==fileDrop&&$("#nps-attach-files").prop("checked")?fileDrop.prepareFormData():null;e=e||new FormData;for(const n in npsGrade)e.set(n,npsGrade[n]);"Viewer"===o.AppName&&$("#nps-attach-files").prop("checked")&&e.set("fileId",documentGuid),showNpsPreloader(),$.ajax({method:"POST",url:o.APIBasePath+"feedback",data:e,processData:!1,contentType:!1,cache:!1,success:e=>{hideNpsPreloader();for(let e=1;e<=NPS_STEP_COUNT;e++)$(`.nps-container > #nps-step-${e}`).css("display",e===r?"flex":"none");a||window.setTimeout(()=>{closeNps()},3e3),void 0!==e.postUrlMessage&&null!=e.postUrlMessage&&0!==e.postUrlMessage.length&&showMessage(e.postUrlMessage)},error:e=>{closeNps()}})}else closeNps()},startNpsSurvey=()=>{$(".nps-container").css("display","flex"),npsShow(null)};function showNpsIfNeeded(){window.dontShowPromo||o.UploadAndRedirect||npsShow()}const setNpsScore=e=>{$(".nps-score").each(function(){$(this).hasClass(`nps-score-${e}`)?$(this).addClass("selected"):$(this).hasClass("selected")&&$(this).removeClass("selected")}),null!=(npsGrade.score=e)&&gaEventSocial(e,"NPS"),NpsCase(1)},NpsCase=(e,t=!1)=>{switch(e){case 1:if(t||null===npsGrade.score){npsGrade.score=null;break}7<=npsGrade.score?(sendNpsScore(6,!0),showNpsStep(6)):(r=$("#nps-score-reason").html().replace("%appName%",o.AppName).replace("%appScore%",npsGrade.score),$("#current-nps-score").text(r),showNpsStep(2));break;case 2:npsGrade.message=t?"":$("#nps-message").val(),void 0===fileDrop&&"Viewer"!==o.AppName?$("#nps-step-3 > .form-check").hide():npsGrade.score<7&&null!==npsGrade.score?$("#nps-attach-files").prop("checked",!0):$("#nps-attach-files").prop("checked",!1),showNpsStep(3);break;case 3:var r=$("#nps-email").val();if(r&&!isValidEmail(r)){$("#invalid-email").text(r),showNpsStep(4);break}NpsCase(4);break;case 4:npsGrade.email=t?"":$("#nps-email").val(),sendNpsScore()}},closeNps=()=>{$(".nps-container").css("display","none")},showNpsPreloader=()=>{$(".nps-preloader").css("display","flex")},hideNpsPreloader=()=>{$(".nps-preloader").css("display","none")};function showNpsStep(e){$(".nps-step").each(function(){$(this).attr("id")==="nps-step-"+e?$(this).css("display","flex"):$(this).css("display","none")})}const npsShow=(e=void 0)=>{let t,r=!1;var a=void 0!==e;try{if(t=JSON.parse(window.localStorage.getItem(NPS_STORAGE_KEY)),!t)throw new Exception;t[o.AppName]||(r=!0)}catch(e){r=!0,t={}}if($(".nps-preloader").css("display","none"),a||!t[o.AppName]){$("#select-nps-score").text($("#nps-will-recommend").html().replace("%appName%",o.AppName));for(let e=1;e<=NPS_STEP_COUNT;e++)$(`.nps-container > #nps-step-${e}`).css("display",1===e?"flex":"none");(a||r)&&($(".nps-container").css("display","flex"),$(".nps-button").css("display","none")),a&&null!==e&&gaEventSocial("Feedback","Download",e)}else $(".nps-button").css("display","flex")};var dmIslogin=!1,dmUserInfo=null,deURL="https://iqbal-elastic",dmSearchLabel="asposedocs",dmSearchUnder="aspose",dmSearchNum=20,dmSearchDefault=!0,dmIsFirst=!0,dmHeaderDiv="DynabicMenuInnerDiv",dmFooterDiv="DynabicMenuFooter",dmUserControlsDiv="DynabicMenuUserControls",dmSearchDiv="DynabicMenuSearchLabel",dmLanguage="English",dmURL="https://menu.containerize.com/";function LoadMenu(e,t){t&&(dmLanguage=t);GetUsernameCookie(e);ShowHeader(e)}function GetUsernameCookie(e){var t="";if(""==(t=Base64.decode(getCookie("UserInfo"))))dmIslogin=!1;else{dmIslogin=!0;try{var r=t.split("&"),a=r[0].split("=")[1],n=r[1].split("=")[1];dmUserInfo=[{key:"UserNameLink",value:""==n?a:n}]}catch(e){}}return t}function LoadContents(o){jQuery.getJSON(dmURL+"api/htmlapi/"+dmLanguage+"/"+o,{format:"json"}).done(function(e){var t=e.BodyHtml,r=e.NoLoginHtml,a=e.LoginHtml,n=e.BodyScript,e=e.FooterHtml;localStorage["bodyhtml"+o+"_"+dmLanguage]=t,localStorage["nloginhtml"+o+"_"+dmLanguage]=r,localStorage["loginhtml"+o+"_"+dmLanguage]=a,localStorage["headscript"+o+"_"+dmLanguage]=n,localStorage["footerhtml"+o+"_"+dmLanguage]=e,localStorage["GetLatest"+o+"_"+dmLanguage]="false",ShowHeader(o)})}function ShowHeader(e){1==dmIsFirst&&(dmIsFirst=!1);dmIslogin?($("#userNLogin").addClass("d-none"),$("#userLogin").removeClass("d-none")):$("#userNLogin").removeClass("d-none");try{if(null!=dmUserInfo&&0<=dmUserInfo.length)for(var t=0;t<dmUserInfo.length;t++)jQuery("#"+dmUserInfo[t].key).html(dmUserInfo[t].value)}catch(e){}"function"==typeof menuLoaded&&menuLoaded()}function SearchClicked(){}function getCookie(e){for(var t=e+"=",r=decodeURIComponent(document.cookie).split(";"),a=0;a<r.length;a++){for(var n=r[a];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""}function setCookie(e,t,r){var a=new Date;a.setTime(a.getTime()+24*r*60*60*1e3);a="expires="+a.toGMTString();document.cookie=e+"="+t+";"+a+";path=/"}var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,r,a,n,o,s,i="",l=0;for(e=Base64._utf8_encode(e);l<e.length;)a=(s=e.charCodeAt(l++))>>2,n=(3&s)<<4|(t=e.charCodeAt(l++))>>4,o=(15&t)<<2|(r=e.charCodeAt(l++))>>6,s=63&r,isNaN(t)?o=s=64:isNaN(r)&&(s=64),i=i+this._keyStr.charAt(a)+this._keyStr.charAt(n)+this._keyStr.charAt(o)+this._keyStr.charAt(s);return i},decode:function(e){var t,r,a,n,o,s,i="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)a=this._keyStr.indexOf(e.charAt(l++)),t=(15&(n=this._keyStr.indexOf(e.charAt(l++))))<<4|(o=this._keyStr.indexOf(e.charAt(l++)))>>2,r=(3&o)<<6|(s=this._keyStr.indexOf(e.charAt(l++))),i+=String.fromCharCode(a<<2|n>>4),64!=o&&(i+=String.fromCharCode(t)),64!=s&&(i+=String.fromCharCode(r));return i=Base64._utf8_decode(i)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t+=String.fromCharCode(a):(127<a&&a<2048?t+=String.fromCharCode(a>>6|192):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128)),t+=String.fromCharCode(63&a|128))}return t},_utf8_decode:function(e){for(var t="",r=0,a=c1=c2=0;r<e.length;)(a=e.charCodeAt(r))<128?(t+=String.fromCharCode(a),r++):191<a&&a<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&a)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),t+=String.fromCharCode((15&a)<<12|(63&c2)<<6|63&c3),r+=3);return t}};function showE2FDialog(){let e=document.getElementById("e2fModal"),t=document.getElementById("e2femail");e.addEventListener("shown.bs.modal",function(){t.focus()});let r=$("#e2fModal");r.keyboard=!1,r.backdrop="static",r.modal("show")}function sendE2F(){var t=$("#e2femail").val();if(t&&isValidEmail(t)){let e=fileDrop.prepareFormData();if(null!==e){jQuery.isEmptyObject(fileDrop2)||fileDrop2.addFilesToFormData(e);t={email:t,subject:$("#e2fsubject").val(),text:$("#e2ftext").val(),exception:window.E2Fexception,isPrivate:$("#e2fprivate").prop("checked"),referer:document.location.pathname,formparameters:JSON.stringify(formParameters)};e.append("Item",JSON.stringify(t));t=o.APIBasePath+"error2forum";const r=$("#e2fModal");$.ajax({method:"POST",url:t,data:e,processData:!1,contentType:!1,cache:!1,timeout:6e5,success:e=>{r.modal("hide"),hideAlert(),showMessage(`<a href="${e}" rel="noopener nofollow">${e}</a>`)},error:function(e){$("#alertE2F").addClass("d-none"),r.modal("hide"),void 0===e.data||void 0===e.data.status?void 0===e.responseJSON||void 0===e.responseJSON.errors[""]?void 0===e.responseText?showAlert("Error "+e.status+": "+e.statusText):showAlert("Error "+e.status+": "+e.responseText):showAlert("Error "+e.status+": "+e.responseJSON.errors[""]):showAlert(e.data.status)}})}}else window.alert(o.ValidationEmail)}const isEbook=location.href.includes("/ebook/");function getInputTypesParameter(e){return getInputTypesParameterByFileDrop(e,fileDrop,"InputTypes")}function getOutputTypeParameterSimple(e){return e.Fields.OutputType=$("#saveAs").length?getOutputTypeSimple():devErrorMessage,e}function getOutputTypeParameterExtended(e){return e.Fields.OutputType=$("#saveAs").length?getOutputTypeExtended():devErrorMessage,e}function getInputTypesParameterByFileDrop(e,t,r){if(null!==t&&null!==t.droppedFiles){const n=[];for(const o of t.droppedFiles){var a=getFileExtension(o);n.indexOf(a)<0&&n.push(a)}0<n.length&&(e.Fields[r]=n)}return e}function getFileExtension(e){e=getExtension(e.name);return null!==e?`.${e}`:"."}function getOutputTypeExtended(){let e=getOutputTypeSimple();var t;return void 0!==e||0<(t=window.location.pathname.split("-")).length&&(e=t[t.length-1]),e}function getOutputTypeSimple(){return $("#saveAs").val()}const devErrorMessage="WARNING: Name error in javascript file. Please inform the development team.";function getWordsFormParameters(){switch(o.AppName.toLowerCase()){case"annotation":case"crop":case"editor":case"organize":case"parser":case"viewer":return getInputTypesOnly();case"assembly":return getFormParametersAssembly();case"comparison":return getFormParametersComparison();case"compress":return getFormParametersCompress();case"conversion":return getFormParametersConversion();case"esign":return getFormParametersESign();case"mailmerge":return getFormParametersMailMerge();case"merger":return getFormParametersMerger();case"ocr":return getFormParametersOCR();case"pagesetup":return getFormParametersPageSetup();case"picresize":return getFormParametersPicResize();case"protect":return getFormParametersProtect();case"redaction":return getFormParametersRedaction();case"removepages":return getFormParametersRemovePages();case"rotate":return getFormParametersRotate();case"search":return getFormParametersSearch();case"signature":return getFormParametersSignature();case"splitter":return getFormParametersSplitter();case"translator":return getFormParametersTranslator();case"unlock":return getFormParametersUnlock();case"watermark":return getFormParametersWatermark();default:return{}}}function getInputTypesOnly(){let e={Fields:{}};return e=getInputTypesParameter(e),e.Fields.hasOwnProperty("InputTypes")?e:{}}function getFormParametersAssembly(){var e={Fields:{}};return e=getOutputTypeParameterSimple(e=getInputTypesParameter(e))}function getFormParametersConversion(){var e={Fields:{}};return e=getOCRParameters(e=getOutputTypeParameterExtended(e=getInputTypesParameter(e)))}function getFormParametersComparison(){var e={Fields:{}};return e=getOutputTypeParameterSimple(e=getIgnoreLetterCaseParameter(e=getGranularityParameter(e=getInputTypes_2_Parameter(e=getInputTypesParameter(e)))))}function getFormParametersCompress(){var e={Fields:{}};return e=getCompressionLevelParameter(e=getInputTypesParameter(e))}function getFormParametersESign(){var e=getInputTypesParameter(e={Fields:{}});return e=getESignActionTypeParameter(e),e=getCertificateTypeParameter(e),e=getESignPasswordParameter(e),e=getAddSignatureLineParameter(e),e=getSignatureLineImageTypeParameter(e)}function getFormParametersMailMerge(){return getFormParametersAssembly()}function getFormParametersMerger(){var e={Fields:{}};return e=getOutputTypeParameterSimple(e=getOCRParameters(e=getInputTypesParameter(e)))}function getFormParametersOCR(){var e={Fields:{}};return e=getOutputTypeParameterSimple(e=getOCRLanguageParameter(e=getInputTypesParameter(e)))}function getFormParametersPageSetup(){var e={Fields:{}};return e=getOutputTypeParameterSimple(e=getPageOrientationParameter(e=getPageMarginsParameter(e=getPageSetupCustomHeightParameter(e=getPageSetupCustomWidthParameter(e=getPageSizeParameter(e=getInputTypesParameter(e)))))))}function getFormParametersPicResize(){var e=getInputTypesParameter(e={Fields:{}});return e=getScaleTypeParameter(e),e=getScaleRatioParameter(e),e=getWidthParameter(e),e=getHeightParameter(e),e=getMaintainAspectRatioParameter(e),e=getPicResizeRotationAngleParameter(e),e=getOutputTypeParameterSimple(e=getFlipParameter(e))}function getFormParametersProtect(){let e={Fields:{}};return e=getInputTypesParameter(e),e=getPasswordParameter(e),e.Fields.hasOwnProperty("InputTypes")||e.Fields.hasOwnProperty("Password")?e:{}}function getFormParametersRedaction(){var e={Fields:{}};return e=getSearchPatternParameter(e=getInputTypesParameter(e)),e=getReplacementParameter(e),e=getReplaceInTextParameter(e),e=getReplaceInCommentsParameter(e),e=getReplaceInMetadataParameter(e),e=getOutputTypeParameterSimple(e=getCaseSensitiveParameter(e))}function getFormParametersRemovePages(){var e={Fields:{}};return e=getOutputTypeParameterSimple(e=getRemovePagesRangeParameter(e=getRemovePagesTypeParameter(e=getInputTypesParameter(e))))}function getFormParametersRotate(){var e={Fields:{}};return e=getRotateRotationAngleParameter(e=getRotatePageRangeParameter(e=getRotateTypeParameter(e=getInputTypesParameter(e))))}function getFormParametersSearch(){let e={Fields:{}};return e=getInputTypesParameter(e),e=getSearchPatternParameter(e),e.Fields.hasOwnProperty("InputTypes")||e.Fields.hasOwnProperty("SearchPattern")?e:{}}function getFormParametersSignature(){var e=getInputTypesParameter(e={Fields:{}});return e=getSignatureTypeParameter(e),e=getSignatureDrawingColorParameter(e),e=getSignatureTextParameter(e),e=getSignatureTextColorParameter(e),e=getSignatureImageTypeParameter(e)}function getFormParametersSplitter(){var e={Fields:{}};return e=getOutputTypeParameterSimple(e=getSplitValueParameter(e=getSplitTypeParameter(e=getInputTypesParameter(e))))}function getFormParametersTranslator(){var e={Fields:{}};return e=getTranslateToParameter(e=getTranslateFromParameter(e=getInputTypesParameter(e)))}function getFormParametersUnlock(){var e={Fields:{}};return e=getOutputTypeParameterSimple(e=getPasswordParameter(e=getInputTypesParameter(e)))}function getFormParametersWatermark(){var e=getInputTypesParameter(e={Fields:{}});return e=getWatermarkActionTypeParameter(e),e=getWatermarkTextParameter(e),e=getWatermarkTextColorParameter(e),e=getWatermarkFontNameParameter(e),e=getWatermarkFontSizeParameter(e),e=getWatermarkTextOrientationParameter(e),e=getWatermarkImageTypeParameter(e),e=getWashoutEffectParameter(e),e=getImageScaleParameter(e)}function getInputTypes_2_Parameter(e){return getInputTypesParameterByFileDrop(e,fileDrop2,"InputTypes_2")}function getOCRParameters(e){const t=$("#OCRCheckboxId");if(t.length){if(!t.hasClass("d-none")){const r=$("#useOCRId");r.length?r.prop("hidden")||(e.Fields.UseOCR=getCheckedValue(r)):e.Fields.UseOCR=devErrorMessage,e=getOCRLanguageParameter(e)}}else e.Fields.UseOCR=devErrorMessage;return e}function getOCRLanguageParameter(e){return getControlValue(e,$("#ocrLanguagesSelect"),"OCRLanguage")}function getCompressionLevelParameter(e){return e.Fields.CompressionLevel=$("#compress").length?getCompressionLevelValue($("input[name=compressLevel]:checked").val()):devErrorMessage,e}function getSplitTypeParameter(e){const t=$("input[name=splitType]:checked");return e.Fields.SplitType=t.length?getSplitTypeValue(t.val()):devErrorMessage,e}function getSplitValueParameter(e){var t="SplitValue";const r=$("input[name=splitType]:checked");if(r.length)switch(r.val()){case"ByNumber":return getTextParameterByControl(e,$("#splitNumber"),t);case"EveryN":return getTextParameterByControl(e,$("#splitEveryN"),t);case"PageRange":return getTextParameterByControl(e,$("#splitRange"),t);case"Every":case"EvenOdd":break;default:e.Fields[t]=devErrorMessage}else e.Fields[t]=devErrorMessage;return e}function getPasswordParameter(e){return getTextParameterByControl(e,$("#passw"),"Password")}function getRotateTypeParameter(e){const t=$("input[type='radio'][name='rotateType']:checked");return e.Fields.RotateType=t.length?getRotateTypeValue(t.val()):devErrorMessage,e}function getRotatePageRangeParameter(e){return isRotateTypeSelectedPages()?getTextParameterByControl(e,$("#rotateRange"),"PageRange"):e}function getRotateRotationAngleParameter(e){return e.Fields.RotationAngle=$("#angle90").length?getRotationAngle():devErrorMessage,e}function getGranularityParameter(e){const t=$("input[name=granularity]:checked");return e.Fields.Granularity=t.length?getGranularityValue(t.val()):devErrorMessage,e}function getIgnoreLetterCaseParameter(e){var t=$("input[id=ignoreCaseChangesId]");return e.Fields.IgnoreLetterCase=t.length?getCheckedValue(t):devErrorMessage,e}function getRemovePagesTypeParameter(e){const t=$("input[type='radio'][name='removeType']:checked");return e.Fields.RemovePagesType=t.length?getRemovePagesTypeValue(t.val()):devErrorMessage,e}function getRemovePagesRangeParameter(e){return isRemovePagesTypeEqualsTo("Selected")?getTextParameterByControl(e,$("#removePagesRange"),"PageRange"):e}function getSearchPatternParameter(e){return getTextParameterByControl(e,$("input[id=searchQuery]"),"SearchPattern")}function getTranslateFromParameter(e){return getControlValue(e,$("#translateFrom"),"TranslateFrom")}function getTranslateToParameter(e){return getControlValue(e,$("#translateTo"),"TranslateTo")}function getESignActionTypeParameter(e){const t=$("input[name=eSignActionType]:checked");return e.Fields.ESignActionType=t.length?getESignActionTypeValue(t.val()):devErrorMessage,e}function getCertificateTypeParameter(e){return isESignActionTypeSign()?getFileTypeParameterByControl(e,$("#eSignCertFile"),"CertificateType"):e}function getESignPasswordParameter(e){return isESignActionTypeSign()?getTextParameterByControl(e,$("#eSignCertPassword"),"ESignPassword"):e}function getAddSignatureLineParameter(e){if(isESignActionTypeSign()){const t=$("input[name=eSignAddSignatureLine]");e.Fields.AddSignatureLine=t.length?getCheckedValue(t):devErrorMessage}return e}function getSignatureLineImageTypeParameter(e){if(isESignActionTypeSign()){const t=$("input[name=eSignAddSignatureLine]");if(t.length&&t.prop("checked"))return getFileTypeParameterByControl(e,$("#eSignSignatureLineImage"),"SignatureLineImageType")}return e}function getScaleTypeParameter(e){const t=$("#scaleType-radio1");return e.Fields.ScaleType=t.length?getScaleTypeValue(t.prop("checked")):devErrorMessage,e}function getScaleRatioParameter(e){return isScaleTypeResizeByPercent()?getControlValue(e,$("#scalePercent"),"ScaleRatio"):e}function getPicResizeRotationAngleParameter(e){return getControlValue(e,$("#angle"),"RotationAngle")}function getFlipParameter(e){const t=$("#flip");return e.Fields.Flip=t.length?getFlipValue(t.val()):devErrorMessage,e}function getWidthParameter(e){return isScaleTypeResizeByPercent()?e:getTextParameterByControl(e,$("#scaleWidth"),"Width")}function getHeightParameter(e){return isScaleTypeResizeByPercent()?e:getTextParameterByControl(e,$("#scaleHeight"),"Height")}function getMaintainAspectRatioParameter(e){if(!isScaleTypeResizeByPercent()){const t=$("#scaleAspectRatio");e.Fields.MaintainAspectRatio=t.length?getCheckedValue(t):devErrorMessage}return e}function getReplacementParameter(e){return getTextParameterByControl(e,$("input[id=replaceText]"),"Replacement")}function getReplaceInTextParameter(e){const t=$("input[id=text]");return e.Fields.ReplaceInText=t.length?getCheckedValue(t):devErrorMessage,e}function getReplaceInCommentsParameter(e){const t=$("input[id=comments]");return e.Fields.ReplaceInComments=t.length?getCheckedValue(t):devErrorMessage,e}function getReplaceInMetadataParameter(e){const t=$("input[id=metadata]");return e.Fields.ReplaceInMetadata=t.length?getCheckedValue(t):devErrorMessage,e}function getCaseSensitiveParameter(e){const t=$("input[id=caseSensitive]");return e.Fields.CaseSensitive=t.length?getCheckedValue(t):devErrorMessage,e}function getSignatureTypeParameter(e){const t=$("input[name=signatureType]:checked");return e.Fields.SignatureType=t.length?getSignatureTypeValue(t.val()):devErrorMessage,e}function getSignatureTextParameter(e){return isSignatureTypeEqualsTo("Text")?getTextParameterByControl(e,$("textarea[name=signatureText]"),"SignatureText"):e}function getSignatureTextColorParameter(e){return isSignatureTypeEqualsTo("Text")?getControlValue(e,$("input[name=signatureColorText]"),"Color"):e}function getSignatureImageTypeParameter(e){return isSignatureTypeEqualsTo("Image")?getFileTypeParameterByControl(e,$("#signatureImageFile"),"SignatureImageType"):e}function getSignatureDrawingColorParameter(e){return isSignatureTypeEqualsTo("Drawing")?getControlValue(e,$("#signatureColorDrawing"),"Color"):e}function getWatermarkActionTypeParameter(e){const t=$("input[name=watermarkType]:checked");return e.Fields.ActionType=t.length?getWatermarkActionTypeValue(t.val()):devErrorMessage,e}function getWatermarkTextParameter(e){return isWatermarkActionTypeEqualsTo("AddTextWatermark")?getTextParameterByControl(e,$("#watermarkText"),"Text"):e}function getWatermarkTextColorParameter(e){return isWatermarkActionTypeEqualsTo("AddTextWatermark")?getControlValue(e,$("#watermarkColor"),"Color"):e}function getWatermarkFontNameParameter(e){return isWatermarkActionTypeEqualsTo("AddTextWatermark")?getControlValue(e,$("#watermarkFont"),"FontName"):e}function getWatermarkFontSizeParameter(e){return isWatermarkActionTypeEqualsTo("AddTextWatermark")?getControlValue(e,$("#watermarkFontSize"),"FontSize"):e}function getWatermarkTextOrientationParameter(e){if(isWatermarkActionTypeEqualsTo("AddTextWatermark")){const t=$("input[name=watermarkAngle]:checked");e.Fields.Orientation=t.length?getWatermarkTextOrientationValue(t.val()):devErrorMessage}return e}function getWatermarkImageTypeParameter(e){return isWatermarkActionTypeEqualsTo("AddImageWatermark")?getFileTypeParameterByControl(e,$("#watermarkImageFile"),"ImageType"):e}function getWashoutEffectParameter(e){if(isWatermarkActionTypeEqualsTo("AddImageWatermark")){const t=$("input[name=watermarkImageIsWashout]");e.Fields.WashoutEffect=t.length?getCheckedValue(t):devErrorMessage}return e}function getImageScaleParameter(e){return isWatermarkActionTypeEqualsTo("AddImageWatermark")?getControlValue(e,$("input[name=watermarkImageScale]"),"Scale"):e}function getESignActionTypeParameter(e){const t=$("input[name=eSignActionType]:checked");return e.Fields.ESignActionType=t.length?getESignActionTypeValue(t.val()):devErrorMessage,e}function getCertificateTypeParameter(e){return isESignActionTypeSign()?getFileTypeParameterByControl(e,$("#eSignCertFile"),"CertificateType"):e}function getESignPasswordParameter(e){return isESignActionTypeSign()?getTextParameterByControl(e,$("#eSignCertPassword"),"ESignPassword"):e}function getAddSignatureLineParameter(e){var t;return isESignActionTypeSign()&&(t=$("input[name=eSignAddSignatureLine]"),e.Fields.AddSignatureLine=t.length?getCheckedValue(t):devErrorMessage),e}function getSignatureLineImageTypeParameter(e){if(isESignActionTypeSign()){const t=$("input[name=eSignAddSignatureLine]");if(t.length&&t.prop("checked"))return getFileTypeParameterByControl(e,$("#eSignSignatureLineImage"),"SignatureLineImageType")}return e}function getScaleTypeParameter(e){const t=$("#scaleType-radio1");return e.Fields.ScaleType=t.length?getScaleTypeValue(t.prop("checked")):devErrorMessage,e}function getScaleRatioParameter(e){return isScaleTypeResizeByPercent()?getControlValue(e,$("#scalePercent"),"ScaleRatio"):e}function getPicResizeRotationAngleParameter(e){return getControlValue(e,$("#angle"),"RotationAngle")}function getFlipParameter(e){const t=$("#flip");return e.Fields.Flip=t.length?getFlipValue(t.val()):devErrorMessage,e}function getWidthParameter(e){return isScaleTypeResizeByPercent()?e:getTextParameterByControl(e,$("#scaleWidth"),"Width")}function getHeightParameter(e){return isScaleTypeResizeByPercent()?e:getTextParameterByControl(e,$("#scaleHeight"),"Height")}function getMaintainAspectRatioParameter(e){var t;return isScaleTypeResizeByPercent()||(t=$("#scaleAspectRatio"),e.Fields.MaintainAspectRatio=t.length?getCheckedValue(t):devErrorMessage),e}function getReplacementParameter(e){return getTextParameterByControl(e,$("input[id=replaceText]"),"Replacement")}function getReplaceInTextParameter(e){var t=$("input[id=text]");return e.Fields.ReplaceInText=t.length?getCheckedValue(t):devErrorMessage,e}function getReplaceInCommentsParameter(e){var t=$("input[id=comments]");return e.Fields.ReplaceInComments=t.length?getCheckedValue(t):devErrorMessage,e}function getReplaceInMetadataParameter(e){var t=$("input[id=metadata]");return e.Fields.ReplaceInMetadata=t.length?getCheckedValue(t):devErrorMessage,e}function getCaseSensitiveParameter(e){var t=$("input[id=caseSensitive]");return e.Fields.CaseSensitive=t.length?getCheckedValue(t):devErrorMessage,e}function getSignatureTypeParameter(e){const t=$("input[name=signatureType]:checked");return e.Fields.SignatureType=t.length?getSignatureTypeValue(t.val()):devErrorMessage,e}function getSignatureTextParameter(e){return isSignatureTypeEqualsTo("Text")?getTextParameterByControl(e,$("textarea[name=signatureText]"),"SignatureText"):e}function getSignatureTextColorParameter(e){return isSignatureTypeEqualsTo("Text")?getControlValue(e,$("input[name=signatureColorText]"),"Color"):e}function getSignatureImageTypeParameter(e){return isSignatureTypeEqualsTo("Image")?getFileTypeParameterByControl(e,$("#signatureImageFile"),"SignatureImageType"):e}function getSignatureDrawingColorParameter(e){return isSignatureTypeEqualsTo("Drawing")?getControlValue(e,$("#signatureColorDrawing"),"Color"):e}function getWatermarkActionTypeParameter(e){const t=$("input[name=watermarkType]:checked");return e.Fields.ActionType=t.length?getWatermarkActionTypeValue(t.val()):devErrorMessage,e}function getWatermarkTextParameter(e){return isWatermarkActionTypeEqualsTo("AddTextWatermark")?getTextParameterByControl(e,$("#watermarkText"),"Text"):e}function getWatermarkTextColorParameter(e){return isWatermarkActionTypeEqualsTo("AddTextWatermark")?getControlValue(e,$("#watermarkColor"),"Color"):e}function getWatermarkFontNameParameter(e){return isWatermarkActionTypeEqualsTo("AddTextWatermark")?getControlValue(e,$("#watermarkFont"),"FontName"):e}function getWatermarkFontSizeParameter(e){return isWatermarkActionTypeEqualsTo("AddTextWatermark")?getControlValue(e,$("#watermarkFontSize"),"FontSize"):e}function getWatermarkTextOrientationParameter(e){if(isWatermarkActionTypeEqualsTo("AddTextWatermark")){const t=$("input[name=watermarkAngle]:checked");e.Fields.Orientation=t.length?getWatermarkTextOrientationValue(t.val()):devErrorMessage}return e}function getWatermarkImageTypeParameter(e){return isWatermarkActionTypeEqualsTo("AddImageWatermark")?getFileTypeParameterByControl(e,$("#watermarkImageFile"),"ImageType"):e}function getWashoutEffectParameter(e){var t;return isWatermarkActionTypeEqualsTo("AddImageWatermark")&&(t=$("input[name=watermarkImageIsWashout]"),e.Fields.WashoutEffect=t.length?getCheckedValue(t):devErrorMessage),e}function getImageScaleParameter(e){return isWatermarkActionTypeEqualsTo("AddImageWatermark")?getControlValue(e,$("input[name=watermarkImageScale]"),"Scale"):e}function getPageSizeParameter(e){const t=$("#pageSize");return e.Fields.Size=t.length?getPageSizeValue(t.val()):devErrorMessage,e}function getPageMarginsParameter(e){const t=$("#pageMargins");return e.Fields.Margins=t.length?getPageMarginsValue(t.val()):devErrorMessage,e}function getPageOrientationParameter(e){const t=$("#pageOrientation");return e.Fields.Orientation=t.length?getPageOrientationValue(t.val()):devErrorMessage,e}function getPageSetupCustomWidthParameter(e){return isPageSizeEqualsTo("Custom")?getTextParameterByControl(e,$("#customWidth"),"CustomWidth"):e}function getPageSetupCustomHeightParameter(e){return isPageSizeEqualsTo("Custom")?getTextParameterByControl(e,$("#customHeight"),"CustomHeight"):e}function getControlValue(e,t,r){return e.Fields[r]=t.length?t.val():devErrorMessage,e}function getTextParameterByControl(e,t,r){return t.length?0<(t=t.val()).length&&(e.Fields[r]=t):e.Fields[r]=devErrorMessage,e}function getFileTypeParameterByControl(e,t,r){return t.length?0<t[0].files.length&&(e.Fields[r]=getFileExtension(t[0].files[0])):e.Fields[r]=devErrorMessage,e}function getFileTypeParameterByControl(e,t,r){return t.length?0<t[0].files.length&&(e.Fields[r]=getFileExtension(t[0].files[0])):e.Fields[r]=devErrorMessage,e}function getCheckedValue(e){return e.prop("checked")?"true":"false"}function isRemovePagesTypeEqualsTo(e){const t=$("input[type='radio'][name='removeType']:checked");return t.length&&getRemovePagesTypeValue(t.val())===e}function isRotateTypeSelectedPages(){const e=$("#rotateSelected");return e.length&&e.prop("checked")}function isESignActionTypeSign(){const e=$("input[name=eSignActionType]:checked");return e.length&&"Sign"===getESignActionTypeValue(e.val())}function isScaleTypeResizeByPercent(){const e=$("#scaleType-radio1");return e.length&&e.prop("checked")}function isSignatureTypeEqualsTo(e){const t=$("input[name=signatureType]:checked");return t.length&&getSignatureTypeValue(t.val())===e}function isWatermarkActionTypeEqualsTo(e){const t=$("input[name=watermarkType]:checked");return t.length&&getWatermarkActionTypeValue(t.val())===e}function isPageSizeEqualsTo(e){const t=$("#pageSize");return t.length&&getPageSizeValue(t.val())===e}function getCompressionLevelValue(e){switch(e){case"0":return"Low";case"1":return"Medium";case"2":return"High";default:return getDevErrorMessage(e)}}function getSplitTypeValue(e){switch(e){case"Every":return"EveryPage";case"EvenOdd":return"OddAndEvenPages";case"EveryN":return"EveryNPages";case"ByNumber":return"ByPageNumber";case"PageRange":return"ByPageRange";default:return getDevErrorMessage(e)}}function getRotateTypeValue(e){switch(e){case"0":return"AllPages";case"1":return"SelectedPages";default:return getDevErrorMessage(e)}}function getRotationAngle(){return $("#angle90").prop("checked")?"90":$("#angle180").prop("checked")?"180":$("#angle270").prop("checked")?"270":devErrorMessage}function getGranularityValue(e){switch(e){case"WordLevel":return"Word";case"CharLevel":return"Char";default:return getDevErrorMessage(e)}}function getRemovePagesTypeValue(e){switch(e){case"0":return"Selected";case"1":return"Blank";default:return getDevErrorMessage(e)}}function getESignActionTypeValue(e){switch(e){case"eSignTabVerify":return"Verify";case"eSignTabSign":return"Sign";default:return getDevErrorMessage(e)}}function getScaleTypeValue(e){return e?"ResizeByPercent":"ResizeByWidthAndHeight"}function getSignatureTypeValue(e){switch(e){case"signatureTabDrawing":return"Drawing";case"signatureTabText":return"Text";case"signatureTabImage":return"Image";default:return getDevErrorMessage(e)}}function getWatermarkActionTypeValue(e){switch(e){case"watermarkTabText":return"AddTextWatermark";case"watermarkTabImage":return"AddImageWatermark";case"watermarkTabRemove":return"RemoveWatermark";default:return getDevErrorMessage(e)}}function getWatermarkTextOrientationValue(e){switch(e){case"Horizontal":return"Horizontally";case"Diagonal":return"Diagonally";default:return getDevErrorMessage(e)}}function getFlipValue(e){switch(e){case"None":return"No";case"Horizontal":return"Horizontally";case"Vertical":return"Vertically";case"Both":return"Both";default:return getDevErrorMessage(e)}}function getPageSizeValue(e){switch(e){case"-1":return"-";case"0":return"A3";case"1":return"A4";case"2":return"A5";case"3":return"B4";case"4":return"B5";case"5":return"Executive";case"6":return"Folio";case"7":return"Ledger";case"8":return"Legal";case"9":return"Letter";case"10":return"EnvelopeDL";case"11":return"Quarto";case"12":return"Statement";case"13":return"Tabloid";case"14":return"Paper10x14";case"15":return"Paper11x17";case"16":return"Number10Envelope";case"17":return"Custom";default:return getDevErrorMessage(e)}}function getPageMarginsValue(e){switch(e){case"-1":return"-";case"0":return"Normal";case"1":return"Narrow";case"2":return"Moderate";case"3":return"Wide";case"4":return"Mirrored";default:return getDevErrorMessage(e)}}function getPageOrientationValue(e){switch(e){case"-1":return"-";case"1":return"Portrait";case"2":return"Landscape";default:return getDevErrorMessage(e)}}function getDevErrorMessage(e){return`${devErrorMessage} id=${e}`}function request(e,t,r,a,n){const o="function"==typeof r?r:workSuccess,s="function"==typeof a?a:errorProcessRequest;formParameters=getWordsFormParameters(),showLoader(),$.ajax({method:"POST",url:e,data:t,dataType:"application/json"===n&&"json",contentType:n||!1,processData:!1,cache:!1,timeout:6e5,success:function(...e){showNpsIfNeeded(),o(...e)},xhr:function(){const e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",progress,!1),e},error:function(e){$("#WorkPlaceHolder").removeClass("d-none"),showedPromo=!1,showNpsIfNeeded(),s(e)}})}function requestJSON(e,t,r,a){request(e,t="string"!=typeof t?JSON.stringify(t):t,r,a,"application/json")}function validateConversion(){var e=getArchiveFilesNumber();return!(1<e||1===e&&0<fileDrop.droppedFiles.length-e)}function requestConversion(){var e;!validateConversion()||null!==(e=fileDrop.prepareFormData())&&request(o.APIBasePath+"convert?outputType="+getOutputTypeExtended()+"&useOcr="+getCheckedValue($("#useOCRId"))+"&locale="+$("#ocrLanguagesSelect").val(),e)}function validateMerger(){var e=fileDrop.droppedFiles.length;return!(e<2||10<e)||(showAlert(o.FileAmountMessage),!1)}function requestMerger(){var e;!validateMerger()||null!==(e=fileDrop.prepareFormData())&&request(o.APIBasePath+"merge?outputType="+getOutputTypeSimple()+"&useOcr="+getCheckedValue($("#useOCRId"))+"&locale="+$("#ocrLanguagesSelect").val(),e)}function requestParser(){var e=fileDrop.prepareFormData();null!==e&&request(o.APIBasePath+"parse",e)}function requestCompress(){var e,t=fileDrop.prepareFormData();null!==t&&(e=$("input[name=compressLevel]:checked").val(),request(o.APIBasePath+"compress?"+(void 0!==e?"level="+e:"outputType="+getOutputTypeExtended()),t))}function requestAnnotation(){var e=fileDrop.prepareFormData();null!==e&&request(o.APIBasePath+"removeAnnotations",e)}function requestMetadata(){var e=o.APIBasePath+"load",t=fileDrop.prepareFormData();null!==t&&$.ajax({method:"POST",url:e,data:t,processData:!1,contentType:!1,cache:!1,timeout:6e5,success:e=>{$.metadata(e.metadata,e.id)},error:e=>{void 0!==e.data&&void 0!==e.data.status?showAlert(e.data.status):showAlert("Error "+e.status+": "+e.statusText)}})}function requestSearch(){var e;!validateSearch()||null!==(e=fileDrop.prepareFormData())&&request(o.APIBasePath+"search?query="+encodeURIComponent($("#searchQuery").val()),e)}function validateUnlock(){return!!$("#passw").val().length||(showAlert(o.validationMessage),!1)}function requestUnlock(){if(validateUnlock()){let e=fileDrop.prepareFormData();null!==e&&(e.set("passw",encodeURIComponent($("#passw").val())),request(o.APIBasePath+"unlock?outputType="+getOutputTypeSimple(),e))}}function validateProtect(){return!!$("#passw").val().length||(showAlert(o.validationMessage),!1)}function requestProtect(){var e;!validateProtect()||null!==(e=fileDrop.prepareFormData())&&request(o.APIBasePath+"protect?passw="+encodeURIComponent($("#passw").val()),e)}function validateComparison(){return 1===fileDrop.droppedFiles.length&&1===fileDrop2.droppedFiles.length||(showAlert(o.FileSelectMessage),!1)}function requestComparison(){if(validateComparison()){let t=fileDrop.prepareFormData();if(null!==t){let e=fileDrop2.prepareFormData();if(null!==e){for(var r of e.entries())t.append(r[0],r[1]);var a=o.APIBasePath+"compare?outputType="+getOutputTypeSimple(),n={IgnoreCaseChanges:$("input[id=ignoreCaseChangesId]").prop("checked"),Granularity:$("input[name=granularity]:checked").val()};t.append("Options",JSON.stringify(n)),request(a,t)}}}}function requestSignature(){let t=fileDrop.prepareFormData();var e,r;null!==t&&("signatureTabText"===(e=$("input[name=signatureType]:checked").val())?(r={Text:$("textarea[name=signatureText]").val(),Color:$("input[name=signatureColorText]").val()},t.append("Options",JSON.stringify(r)),request(o.APIBasePath+"signatureText",t)):"signatureTabImage"===e?1===(r=$("#signatureImageFile")[0].files).length&&(t.append("x-additional-resource-image",r[0]),request(o.APIBasePath+"signatureImage",t)):"signatureTabDrawing"===e&&document.getElementById("signatureDrawingCanvas").toBlob(function(e){t.append("x-additional-resource-image",e),request(o.APIBasePath+"signatureImage",t)}))}function requestReplace(){if(validateSearch()){let e=fileDrop.prepareFormData();var t;null!==e&&(t={SearchPattern:$("input[id=searchQuery]").val(),Replacement:$("input[id=replaceText]").val()},e.append("FindReplaceData",JSON.stringify(t)),t={IsSearchInText:$("input[id=text]").prop("checked"),IsSearchInComments:$("input[id=comments]").prop("checked"),IsSearchInMetadata:$("input[id=metadata]").prop("checked"),IsCaseSensitive:$("input[id=caseSensitive]").prop("checked")},e.append("SearchOptions",JSON.stringify(t)),request(o.APIBasePath+"replace?outputType="+getOutputTypeExtended(),e))}}function validateSearch(){return!!$("#searchQuery").val().length||(showAlert(o.validationSearchMessage),!1)}function requestViewer(){uploadFile(e=>{hideLoader(),openIframe(generateViewerLink(e,window.useNewViewer),window.href,"/words/view")})}function requestEditor(){uploadFile(e=>{hideLoader(),openIframe(generateEditorLink(e),window.href,"/words/edit")})}function requestOCR(){var e=fileDrop.prepareFormData();null!==e&&request(o.APIBasePath+"ocr?locale="+$("#ocrLanguagesSelect").val()+"&outputType="+getOutputTypeSimple(),e)}const VIEWABLE_EXTENSIONS=["doc","docx","docm","dot","dotx","dotm","rtf","mobi","odt","ott","txt","pdf","chm","md"],ARCHIVE_EXTENSIONS=["zip","rar","7z","tar","gz"],IMAGE_EXTENSIONS=["jpg","jpeg","gif","png","bmp","svg","tiff"];function integerFilter(e){return 0===e.length||/^\d*$/.test(e)}function signedIntegerFilter(e){return 0===e.length||/^-?\d*$/.test(e)}function floatFilter(e){return 0===e.length||/^\d*(\.\d*)?$/.test(e)}function signedFloatFilter(e){return 0===e.length||/^-?\d*(\.\d*)?$/.test(e)}function percentsFilter(e){return 0===e.length||/^\d*$/.test(e)&&parseInt(e,10)<=100}let fileDrop={},fileDrop2={},showedPromo=!1,loadedPromo=!1;const _main_min_height="auto";function getExtension(e){var t=e.lastIndexOf(".");return 0<=t?e.substring(t+1).toLowerCase():null}function getArchiveFilesNumber(t){let r=0;for(let e=0;e<fileDrop.droppedFiles.length;e++){var a=getExtension(fileDrop.droppedFiles[e].name);null!==a&&-1!==ARCHIVE_EXTENSIONS.indexOf(a)&&(r+=1)}if(null!=t)for(let e=0;e<t.length;e++){var n=getExtension(t[e].name);null!==n&&-1!==ARCHIVE_EXTENSIONS.indexOf(n)&&(r+=1)}return r}function InitializeSignalR(e){return(new signalR.HubConnectionBuilder).withUrl(e,{transport:signalR.HttpTransportType.WebSockets,skipNegotiation:!0}).withHubProtocol(new signalR.protocols.msgpack.MessagePackHubProtocol).withAutomaticReconnect([0,2e3,2e3,1e4,1e4,3e4,6e4]).configureLogging(signalR.LogLevel.Warning).build()}function fetchError(e){e="string"==typeof e||e instanceof String?e:e.message;showAlert(e)}function showLoader(){$(".progress > .progress-bar").html("5%"),$(".progress > .progress-bar").css("width","5%"),$("#loader").removeClass("d-none"),$("#spinner").removeClass("d-none"),hideAlert()}function hideLoader(){$(".lds-spinner").addClass("d-none"),$("#spinner").addClass("d-none"),$("#loader").addClass("d-none"),$("#main").removeClass("closed")}function showSpinner(){$("#loader").addClass("d-none"),$(".lds-spinner").removeClass("d-none")}function setSpinnerText(e){$("#spinner-text").text(e)}function generateViewerLink(e,t=!1){return t?(console.log(o.UIBasePath.slice(0,o.UIBasePath.length-1)+"2?id="+encodeURIComponent(e)),o.UIBasePath.slice(0,o.UIBasePath.length-1)+"2?id="+encodeURIComponent(e)):o.UIBasePath+"view?id="+encodeURIComponent(e)}function generateEditorLink(e){return o.UIBasePath+"edit?id="+encodeURIComponent(e)}function sendPageView(e){if("ga"in window)try{const t=ga.getAll()[0];void 0!==t&&t.send("pageview",e)}catch(e){}}function workSuccess(t,e,r){if(hideLoader(),hideAlert(),$("#WorkPlaceHolder").addClass("d-none"),$("#DownloadPlaceHolder").removeClass("d-none"),window.dontShowPromo||(showPromo(),document.documentElement.clientWidth<768&&(document.getElementById("main").style.minHeight="auto")),void 0===o.ReturnFromViewer){var a=o.AppDownloadURL.indexOf("?");const n=-1===a?o.AppDownloadURL:o.AppDownloadURL.substring(0,a);sendPageView(n)}let n=o.APIBasePath+"Download?id="+encodeURIComponent(t.id);if($("#DownloadButton").attr("href",n),o.DownloadUrl=n,o.DownloadFileName=t.id.split("/").pop(),o.ShowViewerButton){let e=$("#ViewerLink");a=getExtension(t.id);null!==a&&e.length&&-1!==VIEWABLE_EXTENSIONS.indexOf(a)?e.on("click",function(e){e.preventDefault(),e.stopPropagation(),openIframe(generateViewerLink(t),"/words/viewer","/words/view")}):(e.hide(),$(e[0].parentNode.previousElementSibling).hide())}}function isValidEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function sendEmail(){var e=$("#EmailToInput").val();e&&isValidEmail(e)?(e={appname:o.AppName,email:e,url:o.DownloadUrl,title:"Aspose.Words "+$("#ProductTitle")[0].innerText},$("#sendEmailModal").modal("hide"),$("#sendEmailButton").addClass("d-none"),$.ajax({method:"POST",url:o.APIBasePath+"sendemail",data:e,dataType:"json",success:e=>{showMessage(e.message)},complete:()=>{$("#sendEmailButton").removeClass("d-none"),hideLoader()},error:e=>{showAlert(e.responseJSON.message)}})):window.alert(o.ValidationEmail)}function sendFeedback(e){const t="string"==typeof e?e:$("#feedbackText").val();var r;!t||t.match(/^\s+$/)||1e3<t.length||(r={appname:o.AppName,message:t},e||gaEventSocial("Feedback Right"),$.ajax({method:"POST",url:o.APIBasePath+"feedback",data:r,dataType:"json",success:e=>{showMessage(e.message),$("#feedback").hide()},error:e=>{showAlert(e.responseJSON.message)}}))}function hideAlert(){$("#alertMessage").addClass("d-none"),$("#alertMessage").text(""),$("#alertSuccess").addClass("d-none"),$("#alertSuccess").text(""),$("#alertE2F").addClass("d-none")}function showAlert(e){hideLoader(),$("#alertMessage").html(e),$("#alertMessage").removeClass("d-none"),$("#alertMessage").fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100)}function showMessage(e){hideLoader(),$("#alertSuccess").html(e),$("#alertSuccess").removeClass("d-none")}function showPromo(){showedPromo||(showedPromo=!0,$("#faq").addClass("d-none"),$("#spinner").removeClass("d-none"),o.UploadAndRedirect||($("#main").addClass("closed"),$(".appfeaturesectionlist").addClass("d-none"),$(".app-features-section").removeClass("d-sm-block"),$(".app-product-section").addClass("d-none"),$("#WorkPlaceHolder").addClass("d-none"),$("#content").addClass("d-none"),$(".howtolist").addClass("d-none"),$("#workplace h2").addClass("d-none"),$("#OtherApps").removeClass("d-none"),$("#Promo").removeClass("d-none")))}function progress(e){var t;e.lengthComputable&&(setSpinnerText(o.res.Uploading),t=e.total,e=e.loaded,setProgress(((t=Math.round(100*e/t))<5?5:t)+"%"),99<=t&&progressViaSpinner())}function progressViaSpinner(){o.UploadAndRedirect||(setSpinnerText(o.res.Processing),showSpinner()),window.dontShowPromo||showPromo()}function setProgress(e){$(".progress > .progress-bar").html(e),$(".progress > .progress-bar").css("width",e)}function openIframe(e,t,r){hideLoader(),window.history.pushState(null,null,t),$("body").css("overflow-y","hidden");const a=$('<div id="iframe-wrap"></div>');$("<iframe>",{src:e,id:"iframe-document",frameborder:0,scrolling:"yes"}).appendTo(a),a.appendTo("body")}function closeIframe(){fileDrop.reset(),$("#WorkPlaceHolder").removeClass("d-none"),hideLoader(),$("div#iframe-wrap").remove(),$("body").css("overflow-y","auto"),npsShow()}function errorProcessRequest(e){if(void 0===e.data||void 0===e.data.status)if(void 0===e.responseJSON||void 0===e.responseJSON.errors[""]){if(500===e.status&&void 0!==e.responseText){var t=JSON.parse(e.responseText);if(void 0!==t&&null!=t&&void 0!==t.message)return showAlert(t.message),void(void 0!==t.exception&&null!=t.exception&&(window.E2Fexception=t.exception,$("#alertE2F").removeClass("d-none")))}void 0===e.responseText?showAlert("Error "+e.status+": "+e.statusText):showAlert("Error "+e.status+": "+e.responseText)}else showAlert("Error "+e.status+": "+e.responseJSON.errors[""]);else showAlert(e.data.status)}function uploadFile(e){var t=fileDrop.prepareFormData();null!==t&&request(o.APIBasePath+"upload",t,e)}function prepareDownloadUrl(){o.AppDownloadURL=o.APIBasePath;let e=o.AppDownloadURL.indexOf(":");0<e&&(o.AppDownloadURL=(0<e?o.AppDownloadURL.substring(e+3):o.APIBasePath)+"download"),e=o.AppDownloadURL.indexOf("/"),o.AppDownloadURL=o.AppDownloadURL.substring(e)}function checkReturnFromViewer(){var e,t;0<window.location.search.length&&(o.ReturnFromViewer=!0,e={id:$.QueryString.id},t=window.location.href.split("?")[0],window.history.pushState({},document.title,t),o.UploadAndRedirect||workSuccess(e))}function sendFeedbackExtended(){const e=$("#feedbackBody").val();e&&!e.match(/^.s+$/)&&($("#feedbackModal").modal("hide"),sendFeedback(e))}function otherAppClick(e,t=!1){if("ga"in window)try{const r=window.ga.getAll()[0];void 0!==r&&null!=r&&r.send("event",{eventCategory:"Other App Click"+(t?" Left":""),eventAction:e})}catch(e){}}function expandCollapse(){const e=$(".panelLeft__expand"),t=$(".pbtn"),r=$("#main").first();null!=window._panelLeft_timer&&window.clearTimeout(window._panelLeft_timer),e.length&&t.length&&(e.hasClass("expanded")?(t.each(function(){"1"===$(this).attr("data-collapse").toString()&&$(this).addClass("collapsed")}),e.removeClass("expanded"),r.css("min-height",window._main_min_height)):(window._main_min_height=r.css("min-height"),window._panelLeft_timer=window.setTimeout(()=>{t.each(function(){$(this).hasClass("collapsed")&&$(this).removeClass("collapsed")}),e.addClass("expanded")},1e3),r.css("min-height",34*(2+t.length)+"px")))}function validateStringPageRange(e){let r=!0;if(0===e.length||e.match(/^\s+$/)||-1===e.indexOf(",")&&!e.match(/^\d+$/)&&!e.match(/^\d+\-\d+$/))r=!1;else{let t=e.split(/[,;]/);for(let e=0;e<t.length;e++){if(!t[e].match(/^\d+$/)&&!t[e].match(/^\d+\-\d+$/)){r=!1;break}if(t[e].match(/^\d+\-\d+$/)){var a=t[e].indexOf("-"),n=parseInt(t[e].substring(0,a));if(parseInt(t[e].substring(a+1))<=n){r=!1;break}}}}return r}function InitHeaderAndFooter(){LoadMenu("AsposeApp"),$(".show-hide-menu").click(function(){$(".header").toggleClass("activemenu")})}function updateCloudMessage(e,t){$("#DownloadPlaceHolder .cloud-messages").remove(),e&&0<e.length&&$("#SuccessMessage").after(`<label class="cloud-messages ${t?"":"cloud-messages__fail"}">${e}</label>`)}function loadPromo(){loadedPromo||$.ajax({method:"GET",url:o.APIBasePath+"promo",processData:!1,cache:!1,timeout:6e4,success:function(...e){loadedPromo=!0,void 0!==e[0]&&null!==e[0]&&0<e[0].length&&$("#Promo").html(e[0])},error:function(){loadedPromo=!0}})}document.addEventListener("lazybeforeunveil",function(e){var t=e.target.getAttribute("data-bg");t&&(e.target.style.backgroundImage="url("+t+")")}),$.extend($.expr[":"],{isEmpty:function(e){return""===e.value}}),jQuery.fn.inputFilter=function(e){return this.on("input keydown keyup mousedown mouseup select contextmenu drop",function(){e(this.value)?(this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")?(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd)):this.value=""})},jQuery.QueryString=function(r){let a={};for(let t=0;t<r.length;++t){let e=r[t].split("=",2);2===e.length&&(a[e[0]]=decodeURIComponent(e[1].replace(/\+/g," ")))}return a}(window.location.search.substr(1).split("&")),$(document).ready(function(){prepareDownloadUrl(),checkReturnFromViewer(),fileDrop=$("form#UploadFile").filedrop(Object.assign({showAlert:showAlert,hideAlert:hideAlert,showLoader:showLoader,progress:progress},o),1),"Comparison"===o.AppName&&(fileDrop2=$("form#UploadFile").filedrop(Object.assign({showAlert:showAlert,hideAlert:hideAlert,showLoader:showLoader,progress:progress},o),2)),window.onpopstate=function(e){0<$("div#iframe-wrap").length&&closeIframe()},o.UploadAndRedirect||$("#uploadButton").on("click",o.Method),initalizeGoogleUploadFromButton(),initalizeDropboxUploadFromButton(),$("#UploadToGoogleButton").click(()=>{saveFilesToGoogleDrive(o.DownloadFileName,o.APIBasePath)}),$("#UploadToDropboxButton").click(()=>{saveFilesToDropbox(o.DownloadFileName)}),$("#ProductImage").on("click",()=>{gaEventSocial("WordsImage")}),$("#AsposeProductTitle").on("click",()=>{gaEventSocial("WordsTitle")}),$("#otherFiles").on("click",()=>{gaEventSocial("Other Files","Download")}),$("#acontent").on("click",()=>{gaEventSocial("WordsContent",void 0,el.target.href)}),$(".acontent").on("click",e=>{gaEventSocial("WordsContent",void 0,e.target.href)}),$(".otherfeatures a").on("click",e=>{gaEventSocial("OtherFeature",void 0,e.target.text)}),$("#PoweredBy").on("click",()=>{gaEventSocial("WordsPoweredBy")}),$("#googledrive-btn").on("click",()=>{gaEventSocial("From GoogleDrive","CloudStorage")}),$("#dropbox-btn").on("click",()=>{gaEventSocial("From Dropbox")}),$("#UploadToGoogleButton").on("click",()=>{gaEventSocial("Upload to GoogleDrive")}),$("#UploadToDropboxButton").on("click",()=>{gaEventSocial("Upload to Dropbox")}),$(".promo").on("click",e=>{e=e.target.getAttribute("data-label");null!=e&&0!==e.length&&gaEventSocial(e,"Promo")}),$(document).on("keydown",function(e){"KeyD"!==e.originalEvent.code||!e.originalEvent.ctrlKey||e.originalEvent.altKey||e.originalEvent.shiftKey||e.originalEvent.metaKey||gaEventSocial("Target: "+window.location.pathname,"[Ctrl + D] keypress")}),window.useNewViewer=!1,$(document).on("keydown",function(e){e.originalEvent.ctrlKey&&e.originalEvent.altKey&&"KeyV"===e.originalEvent.code&&(window.useNewViewer=!0,showMessage("Using new Viewer")),"KeyQ"===e.originalEvent.code&&e.originalEvent.ctrlKey&&e.originalEvent.altKey&&e.originalEvent.shiftKey&&!e.originalEvent.metaKey&&($("#DynabicMenuInnerDiv").hide(),$("#panel-left-buttons").hide(),$("#social-panel").hide(),$("#developerPromo").hide(),$("#mobileWorkplacePromo").hide(),$("#poweredByTitle").hide(),$("#breadcrumb").hide(),$("#terms").hide(),$(".fb-like").hide(),$("#divByChapters").removeClass("d-none"),$("#locale").css({top:"15px"}),$("#main").css({"min-height":"800px"}),"Conversion"===o.AppName&&($(".uploadrow").removeClass("mt-1"),$(".uploadrow").addClass("mt-5")),window.scrollTo(0,0),window.dontShowPromo=!0)}),$("#bookmarkModal").on("show.bs.modal",function(e){$("#bookmarkModal").css("display","flex"),$("#bookmarkModal").on("keydown",function(e){(e.metaKey||e.ctrlKey)&&"d"===String.fromCharCode(e.which).toLowerCase()&&$("#bookmarkModal").modal("hide")})}),$("#bookmarkModal").on("hidden.bs.modal",function(e){$("#bookmarkModal").off("keydown")}),$("#sendEmailButton").on("click",function(){gaEventSocial("Send Email","Download"),$("#sendEmailModal").modal({keyboard:!0})}),$("#sendEmailModal").on("show.bs.modal",function(){$("#sendEmailModal").css("display","flex")}),$("#sendEmailModal").on("shown.bs.modal",function(){$("#EmailToInput").focus()}),$("#feedbackModal").on("show.bs.modal",function(e){$("#feedbackModal").css("display","flex")}),$("#feedbackModal").on("shown.bs.modal",function(){$("#feedbackBody").focus()})});let prevOutputFormat="";const showOCRControlsIfNeeded=function(){const e=$("#saveAs").val();for(var t of fileDrop.droppedFiles)if(isImage(getExtension(t.name))){"conversion"===o.AppName.toLowerCase()&&("txt"===e.toLowerCase()?($("#useOCRId").prop("checked",!0),hideDontShowOCRCheckbox(!0)):hideDontShowOCRCheckbox(!1)),$("#OCRCheckboxId").removeClass("d-none");break}},hideOCRControls=function(){$("#OCRCheckboxId").addClass("d-none"),$("#useOCRId").prop("checked",!1)},showOrHideOCRControls=function(){var e=$("#saveAs").val();e!==prevOutputFormat&&("txt"===prevOutputFormat.toLowerCase()&&"conversion"===o.AppName.toLowerCase()&&$("#useOCRId").prop("checked",!1),prevOutputFormat=e),(isImage(e)?hideOCRControls:showOCRControlsIfNeeded)()},hideDontShowOCRCheckbox=function(e){$("#useOCRId").prop("hidden",e),$("#useOCRSpanId").prop("hidden",!e),$("#useOCRLabelId").prop("hidden",e)},isImage=function(e){return null!==e&&-1!==IMAGE_EXTENSIONS.indexOf(e.toLowerCase())};$(document).ready(()=>{0<$("#OCRCheckboxId").length&&(prevOutputFormat=$("#saveAs").val(),fileDrop.on("upload",showOrHideOCRControls),fileDrop.on("remove",hideOCRControls),$("#saveAs").on("change",showOrHideOCRControls))});